{% extends 'layouts/adminlte_base.html' %}
{% set title = 'Mi Panel' %}

{% block page_header %}
<div class="row mb-2">
  <div class="col-sm-6">
    <h1 class="m-0">Mi panel</h1>
  </div>
  <div class="col-sm-6">
    <ol class="breadcrumb float-sm-right">
      <li class="breadcrumb-item"><a href="{{ url_for('index') }}">Inicio</a></li>
      <li class="breadcrumb-item active">Dashboard</li>
    </ol>
  </div>
</div>
{% endblock %}

{% block content %}
<div class="row">
  <div class="col-lg-4 col-6">
    <div class="small-box bg-info">
      <div class="inner">
        <h3>{{ stats.get('mis_reservas_hoy', 0) }}</h3>
        <p>Mis reservas de hoy</p>
      </div>
      <div class="icon"><i class="fas fa-calendar-day"></i></div>
      <a href="{{ url_for('reservas.index') }}" class="small-box-footer">Ir a Reservas <i class="fas fa-arrow-circle-right"></i></a>
    </div>
  </div>
  <div class="col-lg-4 col-6">
    <div class="small-box bg-success">
      <div class="inner">
        <h3>{{ stats.get('tiempo_uso_semana', 0) }}<sup style="font-size: 20px">h</sup></h3>
        <p>Tiempo de uso esta semana</p>
      </div>
      <div class="icon"><i class="fas fa-stopwatch"></i></div>
      <a href="{{ url_for('uso.index') }}" class="small-box-footer">Ver detalle <i class="fas fa-arrow-circle-right"></i></a>
    </div>
  </div>
  <div class="col-lg-4 col-6">
    <div class="small-box bg-warning">
      <div class="inner">
        <h3>{{ stats.get('incidencias_reportadas', 0) }}</h3>
        <p>Mis incidencias</p>
      </div>
      <div class="icon"><i class="fas fa-tools"></i></div>
      <a href="{{ url_for('incidencias.index') }}" class="small-box-footer">Reportar/Ver <i class="fas fa-arrow-circle-right"></i></a>
    </div>
  </div>
</div>

<div class="card">
  <div class="card-header"><h3 class="card-title">Reservas recientes</h3></div>
  <div class="card-body p-0">
    <table class="table table-striped mb-0">
      <thead><tr><th>Recurso</th><th>Fecha</th><th>Hora</th><th>Estado</th></tr></thead>
      <tbody>
      {% for r in reservas_recientes or [] %}
        <tr>
          <td>{{ r.recurso }}</td>
          <td>{{ r.fecha }}</td>
          <td>{{ r.hora }}</td>
          <td><span class="badge badge-{{ 'success' if r.estado=='CONFIRMADA' else 'secondary' }}">{{ r.estado }}</span></td>
        </tr>
      {% else %}
        <tr><td colspan="4" class="text-center text-muted">No tienes reservas a√∫n</td></tr>
      {% endfor %}
      </tbody>
    </table>
  </div>
</div>
{% endblock %}
